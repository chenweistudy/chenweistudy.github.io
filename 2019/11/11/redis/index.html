<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Redis基本命令和java基本操作 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Redis基础篇1.redis的基本命令(1)连接操作命令quit：关闭连接（connection）  auth：简单密码认证  help cmd： 查看cmd帮助，例如：help quit(2)持久化save：将数据同步保存到磁盘  bgsave：将数据异步保存到磁盘  lastsave：返回上次成功将数据保存到磁盘的Unix时戳  shundown：将数据同步保存到磁盘，然后关闭服务(3)远程">
<meta name="keywords" content="redis">
<meta property="og:type" content="article">
<meta property="og:title" content="Redis基本命令和java基本操作">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2019&#x2F;11&#x2F;11&#x2F;redis&#x2F;index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Redis基础篇1.redis的基本命令(1)连接操作命令quit：关闭连接（connection）  auth：简单密码认证  help cmd： 查看cmd帮助，例如：help quit(2)持久化save：将数据同步保存到磁盘  bgsave：将数据异步保存到磁盘  lastsave：返回上次成功将数据保存到磁盘的Unix时戳  shundown：将数据同步保存到磁盘，然后关闭服务(3)远程">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2019-11-11T03:03:03.571Z">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-redis" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/11/11/redis/" class="article-date">
  <time datetime="2019-11-11T02:01:24.000Z" itemprop="datePublished">2019-11-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/redis/">redis</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Redis基本命令和java基本操作
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Redis基础篇"><a href="#Redis基础篇" class="headerlink" title="Redis基础篇"></a>Redis基础篇</h1><h1 id=""><a href="#" class="headerlink" title=""></a></h1><h2 id="1-redis的基本命令"><a href="#1-redis的基本命令" class="headerlink" title="1.redis的基本命令"></a>1.redis的基本命令</h2><h1 id="-1"><a href="#-1" class="headerlink" title=""></a></h1><h4 id="1-连接操作命令"><a href="#1-连接操作命令" class="headerlink" title="(1)连接操作命令"></a>(1)连接操作命令</h4><pre><code>quit：关闭连接（connection）

auth：简单密码认证

help cmd： 查看cmd帮助，例如：help quit</code></pre><h4 id="2-持久化"><a href="#2-持久化" class="headerlink" title="(2)持久化"></a>(2)持久化</h4><pre><code>save：将数据同步保存到磁盘

bgsave：将数据异步保存到磁盘

lastsave：返回上次成功将数据保存到磁盘的Unix时戳

shundown：将数据同步保存到磁盘，然后关闭服务</code></pre><h4 id="3-远程服务控制"><a href="#3-远程服务控制" class="headerlink" title="(3)远程服务控制"></a>(3)远程服务控制</h4><pre><code>info：提供服务器的信息和统计

monitor：实时转储收到的请求

slaveof：改变复制策略设置

config：在运行时配置Redis服务器</code></pre><h4 id="4-对value操作的命令"><a href="#4-对value操作的命令" class="headerlink" title="(4)对value操作的命令"></a>(4)对value操作的命令</h4><pre><code>exists(key)：确认一个key是否存在

del(key)：删除一个key

type(key)：返回值的类型

keys(pattern)：返回满足给定pattern的所有key

randomkey：随机返回key空间的一个

keyrename(oldname, newname)：重命名key

dbsize：返回当前数据库中key的数目

expire：设定一个key的活动时间（s）

ttl：获得一个key的活动时间

select(index)：按索引查询

move(key, dbindex)：移动当前数据库中的key到dbindex数据库

flushdb：删除当前选择数据库中的所有key

flushall：删除所有数据库中的所有key</code></pre><h4 id="5-String"><a href="#5-String" class="headerlink" title="(5)String"></a>(5)String</h4><pre><code>set(key, value)：给数据库中名称为key的string赋予值value

get(key)：返回数据库中名称为key的string的value

getset(key, value)：给名称为key的string赋予上一次的value

mget(key1, key2,…, key N)：返回库中多个string的value

setnx(key, value)：添加string，名称为key，值为value

setex(key, time, value)：向库中添加string，设定过期时间time

mset(key N, value N)：批量设置多个string的值

msetnx(key N, value N)：如果所有名称为key i的string都不存在

incr(key)：名称为key的string增1操作

incrby(key, integer)：名称为key的string增加integer

decr(key)：名称为key的string减1操作

decrby(key, integer)：名称为key的string减少integer

append(key, value)：名称为key的string的值附加value

substr(key, start, end)：返回名称为key的string的value的子串</code></pre><h4 id="6-List"><a href="#6-List" class="headerlink" title="(6)List"></a>(6)List</h4><pre><code>rpush(key, value)：在名称为key的list尾添加一个值为value的元素

lpush(key, value)：在名称为key的list头添加一个值为value的 元素

llen(key)：返回名称为key的list的长度

lrange(key, start, end)：返回名称为key的list中start至end之间的元素

ltrim(key, start, end)：截取名称为key的list

lindex(key, index)：返回名称为key的list中index位置的元素

lset(key, index, value)：给名称为key的list中index位置的元素赋值

lrem(key, count, value)：删除count个key的list中值为value的元素

lpop(key)：返回并删除名称为key的list中的首元素

rpop(key)：返回并删除名称为key的list中的尾元素

blpop(key1, key2,… key N, timeout)：lpop命令的block版本。

brpop(key1, key2,… key N, timeout)：rpop的block版本。

rpoplpush(srckey, dstkey)：返回并删除名称为srckey的list的尾元素，并将该元素添加到名称为dstkey的list的头部</code></pre><h4 id="7-Set"><a href="#7-Set" class="headerlink" title="(7)Set"></a>(7)Set</h4><pre><code>sadd(key, member)：向名称为key的set中添加元素member

srem(key, member) ：删除名称为key的set中的元素member

spop(key) ：随机返回并删除名称为key的set中一个元素

smove(srckey, dstkey, member) ：移到集合元素

scard(key) ：返回名称为key的set的基数

sismember(key, member) ：member是否是名称为key的set的元素

sinter(key1, key2,…key N) ：求交集

sinterstore(dstkey, (keys)) ：求交集并将交集保存到dstkey的集合

sunion(key1, (keys)) ：求并集

sunionstore(dstkey, (keys)) ：求并集并将并集保存到dstkey的集合

sdiff(key1, (keys)) ：求差集

sdiffstore(dstkey, (keys)) ：求差集并将差集保存到dstkey的集合

smembers(key) ：返回名称为key的set的所有元素

srandmember(key) ：随机返回名称为key的set的一个元素</code></pre><h4 id="8-Hash"><a href="#8-Hash" class="headerlink" title="(8)Hash"></a>(8)Hash</h4><pre><code>hset(key, field, value)：向名称为key的hash中添加元素field

hget(key, field)：返回名称为key的hash中field对应的value

hmget(key, (fields))：返回名称为key的hash中field i对应的value

hmset(key, (fields))：向名称为key的hash中添加元素field 

hincrby(key, field, integer)：将名称为key的hash中field的value增加integer

hexists(key, field)：名称为key的hash中是否存在键为field的域

hdel(key, field)：删除名称为key的hash中键为field的域

hlen(key)：返回名称为key的hash中元素个数

hkeys(key)：返回名称为key的hash中所有键

hvals(key)：返回名称为key的hash中所有键对应的value

hgetall(key)：返回名称为key的hash中所有的键（field）及其对应的value</code></pre><h2 id="2-java对redis的基本操作"><a href="#2-java对redis的基本操作" class="headerlink" title="2.java对redis的基本操作"></a>2.java对redis的基本操作</h2><h4 id="2-1-pom-xml"><a href="#2-1-pom-xml" class="headerlink" title="2.1 pom.xml"></a>2.1 pom.xml</h4><pre><code>&lt;dependency&gt;
    &lt;groupId&gt;redis.clients&lt;/groupId&gt;
    &lt;artifactId&gt;jedis&lt;/artifactId&gt;
    &lt;version&gt;2.1.0&lt;/version&gt;
&lt;/dependency&gt;
  &lt;!-- https://mvnrepository.com/artifact/commons-pool/commons-pool --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;commons-pool&lt;/groupId&gt;
    &lt;artifactId&gt;commons-pool&lt;/artifactId&gt;
    &lt;version&gt;1.5.6&lt;/version&gt;
&lt;/dependency&gt;</code></pre><h4 id="2-2redisClient"><a href="#2-2redisClient" class="headerlink" title="2.2redisClient"></a>2.2redisClient</h4><pre><code>public class RedisClient {

/**
 * 所谓的切片,就是客户端可以同时连到多个服务器,如果其中一个服务器挂掉,客户端可以切换到另一服务器,
 * 例如nginx做http转发,转发的目标机器有两台.其中一台为主机,另一台为备用机,如果主机挂掉,nginx可以自动转往备用机;
 */
private Jedis jedis;//非切片额客户度连接
private JedisPool jedisPool;//非切片连接池
private ShardedJedis shardedJedis;//切片额客户端连接
private ShardedJedisPool shardedJedisPool;//切片额客户端连接池

public RedisClient(){
    InitJedisPool();
    InitShardedJedisPool();
    jedis = jedisPool.getResource();
    shardedJedis = shardedJedisPool.getResource();
}
/**
 * 初始化非切片额连接池
 * maxIdle，最大空闲数，数据库连接的最大空闲时间。超过空闲时间，数据库连接将被标记为不可用，然后被释放。设为0表示无限制。
 * MaxActive，连接池的最大数据库连接数。设为0表示无限制。
 * maxWait ，最大建立连接等待时间。如果超过此时间将接到异常。设为-1表示无限制。
 */
public void InitJedisPool(){
    JedisPoolConfig config = new JedisPoolConfig();
    config.setMaxActive(20);
    config.setMaxIdle(2);
    config.setMaxWait(10001);
    config.setTestOnBorrow(false);
    jedisPool = new JedisPool(config, &quot;127.0.0.1&quot;, 6379);
}

/**
 * 初始化切片池
 */
public void InitShardedJedisPool(){
    JedisPoolConfig config = new JedisPoolConfig();
    config.setMaxActive(20);
    config.setMaxIdle(2);
    config.setMaxWait(10001);
    config.setTestOnBorrow(false);

    List&lt;JedisShardInfo&gt; list = new ArrayList&lt;JedisShardInfo&gt;();
    list.add(new JedisShardInfo(&quot;127.0.0.1&quot;, 6379, &quot;master&quot;));

    shardedJedisPool = new ShardedJedisPool(config, list);

}

public void show(){
    KeyOperate();

    jedisPool.returnResource(jedis);
    shardedJedisPool.returnResource(shardedJedis);

}
/**
 * 对value操作的命令
 */
private void KeyOperate(){
    System.out.println(&quot;------------key----------------&quot;);
    System.out.println(&quot;清空所有数据：&quot;+jedis.flushDB());
    //判断k99是否存在：
    Boolean exists = jedis.exists(&quot;k99&quot;);
    System.out.println(&quot;k99是否存在：&quot;+exists);
    jedis.set(&quot;k001&quot;, &quot;value001&quot;);
    String string = jedis.get(&quot;k001&quot;);
    System.out.println(&quot;k001 value = &quot;+string);
    System.out.println(jedis.type(&quot;k001&quot;));

    shardedJedis.set(&quot;k002&quot;, &quot;value002&quot;);
    System.out.println(shardedJedis.get(&quot;k002&quot;));

    //系统中所有的键，使用“*”
    Set&lt;String&gt; keys = jedis.keys(&quot;*&quot;);
    Iterator&lt;String&gt; iterator = keys.iterator();
    while(iterator.hasNext()){
        String next = iterator.next();
        String value = jedis.get(next);
        System.out.println(next+&quot;:&quot;+value);    
    }

    //删除一个key
    jedis.del(&quot;k001&quot;);
    String k001 = jedis.get(&quot;k001&quot;);
    System.out.println(k001);

    //设置key002的过期时间
    Long expire = jedis.expire(&quot;k002&quot;, 10);

    try {
        Thread.sleep(2000);
    } catch (InterruptedException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    System.out.println(&quot;k002剩余存活时间：&quot;+jedis.ttl(&quot;k002&quot;));

    //移除k002生存时间
    jedis.persist(&quot;k002&quot;);
    //永久生存或者不存在的都返回-1
    System.out.println(&quot;k002剩余存活时间：&quot;+jedis.ttl(&quot;k002&quot;));

}
public static void main(String[] args) {
    new RedisClient().show();
    }
}</code></pre>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/11/11/redis/" data-id="ck2tussr50002zgwagg2qd60c" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/redis/" rel="tag">redis</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2019/11/08/test/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">&#39;test&#39;</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/redis/">redis</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/" rel="tag">redis</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/redis/" style="font-size: 10px;">redis</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/11/11/redis/">Redis基本命令和java基本操作</a>
          </li>
        
          <li>
            <a href="/2019/11/08/test/">&#39;test&#39;</a>
          </li>
        
          <li>
            <a href="/2019/11/08/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>